import S from"./BRavzdfR.js";import{m as i,h as u,A as b,I as w,K as E,c as P,i as H,o as d,a as p,S as L,U as O}from"./COTDyTcT.js";const T=["preload","playsinline","autoplay","initplay","loop","muted","controls","poster"],U=["src","type"],x={__name:"VideoStrapi",props:{video:{type:Object,default:null},initplay:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},muted:{type:Boolean,default:!0},playsinline:{type:Boolean,default:!0},controls:{type:Boolean,default:!1},poster:{type:String,default:""},preload:{type:String,default:"auto"},width:{type:String,default:"100%"},height:{type:String,default:"100%"},thumbnail:{type:String,default:""},playOnClick:{type:Boolean,default:!1},checkAudio:{type:Boolean,default:!1}},emits:["play","hasaudio"],setup(a,{emit:c}){const t=i(null),l=a,n=c,y=()=>{n("play",!0)},f=()=>{n("play",!1)},m=()=>{n("play",!1)},v=()=>{l.autoplay||(t.value.paused?t.value.play():t.value.pause())},h=u(()=>l.thumbnail?`#t=${l.thumbnail}`:""),r=u(()=>`${l.video.url}${h.value}`),B=u(()=>l.poster||""),k=e=>e.mozHasAudio||!!e.webkitAudioDecodedByteCount||!!e.audioTracks?.length,g=()=>{const e=document.createElement("video");return e.muted=!0,e.crossOrigin="anonymous",e.preload="auto",new Promise((o,A)=>{e.addEventListener("error",A),e.addEventListener("canplay",()=>{e.currentTime=.99},{once:!0}),e.addEventListener("seeked",()=>o(k(e)),{once:!0}),e.src=r.value})},s=i({play:y,pause:f,ended:m});return l.playOnClick&&(s.value.click=v),b(async()=>{if(l.checkAudio){const e=await g().then(o=>o).catch(()=>!1);n("hasaudio",e)}}),w(()=>{t.value&&(t.value.pause(),t.value.currentTime=0,t.value.muted=!0,t.value.autoplay=!1,t.value.loop=!1,t.value.removeAttribute("src"),t.value.load())}),E(()=>l.initplay,()=>{!l.autoplay&&l.initplay?t.value.play():t.value.pause()}),(e,o)=>a.video?(d(),P("video",L({key:0,ref_key:"videoRef",ref:t,preload:a.preload,loading:"lazy",playsinline:a.playsinline,autoplay:a.autoplay,initplay:a.initplay,loop:a.loop,muted:a.muted,controls:a.controls,poster:B.value},O(s.value)),[o[0]||(o[0]=p("p",null,"Your browser doesn't support HTML5 video",-1)),p("source",{src:r.value,type:a.video.mime},null,8,U)],16,T)):(d(),H(S,{key:1}))}};export{x as default};
